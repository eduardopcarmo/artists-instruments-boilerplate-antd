{"ast":null,"code":"var _jsxFileName = \"D:\\\\Projects\\\\artists-instruments-boilerplate-antd\\\\client\\\\src\\\\components\\\\forms\\\\AddInstrument.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useMutation } from '@apollo/react-hooks';\nimport { Form, Input, Button, Select } from 'antd';\nimport { v4 as uuidv4 } from 'uuid';\nimport { ADD_INSTRUMENT, GET_INSTRUMENTS, GET_ARTISTS } from '../../queries';\nconst {\n  Option\n} = Select;\n\nconst AddInstrument = () => {\n  const {\n    loading,\n    error,\n    data\n  } = useQuery(GET_ARTISTS);\n  const [id] = useState(uuidv4());\n  const [addInstrument] = useMutation(ADD_INSTRUMENT);\n  const [form] = Form.useForm();\n  const [, forceUpdate] = useState(); // To disable submit button at the beginning.\n\n  useEffect(() => {\n    forceUpdate({});\n  }, []);\n\n  const onFinish = values => {\n    const {\n      firstName,\n      lastName\n    } = values;\n    addInstrument({\n      variables: {\n        id,\n        year,\n        brand,\n        type,\n        price,\n        artistId\n      },\n      optimisticResponse: {\n        __typename: 'Mutation',\n        addInstrument: {\n          __typename: 'Instrument',\n          id,\n          year,\n          brand,\n          type,\n          price,\n          artistId\n        }\n      },\n      update: (proxy, {\n        data: {\n          addInstrument\n        }\n      }) => {\n        const data = proxy.readQuery({\n          query: GET_INSTRUMENTS\n        });\n        proxy.writeQuery({\n          query: GET_INSTRUMENTS,\n          data: { ...data,\n            instruments: [...data.instruments, addInstrument]\n          }\n        });\n      }\n    });\n  };\n\n  if (loading) return 'Loading...';\n  if (error) return `Errror! ${error.message}`;\n  return /*#__PURE__*/React.createElement(Form, {\n    form: form,\n    name: \"add-instrument-form\",\n    layout: \"inline\",\n    onFinish: onFinish,\n    size: \"large\",\n    style: {\n      marginBottom: '40px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"year\",\n    rules: [{\n      required: true,\n      message: 'Please input the instrument year!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    placeholder: \"i.e. 1982\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"brand\",\n    rules: [{\n      required: true,\n      message: 'Please input the instrument brand!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    placeholder: \"i.e. Yamaha\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"type\",\n    rules: [{\n      required: true,\n      message: 'Please input the instrument type!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    placeholder: \"i.e. Piano\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"price\",\n    rules: [{\n      required: true,\n      message: 'Please input the instrument price!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    placeholder: \"i.e. 1000\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"artistId\",\n    rules: [{\n      required: true,\n      message: 'Please input the instrument artistId!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Select, {\n    defaultValue: \"\",\n    style: {\n      width: 120\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Option, {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }\n  }), data.map(item => {\n    return /*#__PURE__*/React.createElement(Option, {\n      value: item.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 15\n      }\n    }, `${item.firstName} ${item.lastName}`);\n  }))), /*#__PURE__*/React.createElement(Form.Item, {\n    shouldUpdate: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }\n  }, () => /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    disabled: !form.isFieldsTouched(true) || form.getFieldsError().filter(({\n      errors\n    }) => errors.length).length,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }, \"Add Instrument\")));\n};\n\nexport default AddInstrument;","map":{"version":3,"sources":["D:/Projects/artists-instruments-boilerplate-antd/client/src/components/forms/AddInstrument.js"],"names":["React","useEffect","useState","useMutation","Form","Input","Button","Select","v4","uuidv4","ADD_INSTRUMENT","GET_INSTRUMENTS","GET_ARTISTS","Option","AddInstrument","loading","error","data","useQuery","id","addInstrument","form","useForm","forceUpdate","onFinish","values","firstName","lastName","variables","year","brand","type","price","artistId","optimisticResponse","__typename","update","proxy","readQuery","query","writeQuery","instruments","message","marginBottom","required","width","map","item","isFieldsTouched","getFieldsError","filter","errors","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useMutation } from '@apollo/react-hooks';\r\n\r\nimport { Form, Input, Button, Select } from 'antd';\r\n\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nimport { ADD_INSTRUMENT, GET_INSTRUMENTS, GET_ARTISTS } from '../../queries';\r\n\r\nconst { Option } = Select;\r\n\r\nconst AddInstrument = () => {\r\n  const { loading, error, data } = useQuery(GET_ARTISTS);\r\n\r\n  const [id] = useState(uuidv4());\r\n  const [addInstrument] = useMutation(ADD_INSTRUMENT);\r\n\r\n  const [form] = Form.useForm();\r\n  const [, forceUpdate] = useState();\r\n\r\n  // To disable submit button at the beginning.\r\n  useEffect(() => {\r\n    forceUpdate({});\r\n  }, []);\r\n\r\n  const onFinish = (values) => {\r\n    const { firstName, lastName } = values;\r\n\r\n    addInstrument({\r\n      variables: {\r\n        id,\r\n        year,\r\n        brand,\r\n        type,\r\n        price,\r\n        artistId,\r\n      },\r\n      optimisticResponse: {\r\n        __typename: 'Mutation',\r\n        addInstrument: {\r\n          __typename: 'Instrument',\r\n          id,\r\n          year,\r\n          brand,\r\n          type,\r\n          price,\r\n          artistId,\r\n        },\r\n      },\r\n      update: (proxy, { data: { addInstrument } }) => {\r\n        const data = proxy.readQuery({ query: GET_INSTRUMENTS });\r\n        proxy.writeQuery({\r\n          query: GET_INSTRUMENTS,\r\n          data: {\r\n            ...data,\r\n            instruments: [...data.instruments, addInstrument],\r\n          },\r\n        });\r\n      },\r\n    });\r\n  };\r\n\r\n  if (loading) return 'Loading...';\r\n  if (error) return `Errror! ${error.message}`;\r\n\r\n  return (\r\n    <Form\r\n      form={form}\r\n      name=\"add-instrument-form\"\r\n      layout=\"inline\"\r\n      onFinish={onFinish}\r\n      size=\"large\"\r\n      style={{ marginBottom: '40px' }}\r\n    >\r\n      <Form.Item\r\n        name=\"year\"\r\n        rules={[\r\n          { required: true, message: 'Please input the instrument year!' },\r\n        ]}\r\n      >\r\n        <Input placeholder=\"i.e. 1982\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        name=\"brand\"\r\n        rules={[\r\n          { required: true, message: 'Please input the instrument brand!' },\r\n        ]}\r\n      >\r\n        <Input placeholder=\"i.e. Yamaha\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        name=\"type\"\r\n        rules={[\r\n          { required: true, message: 'Please input the instrument type!' },\r\n        ]}\r\n      >\r\n        <Input placeholder=\"i.e. Piano\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        name=\"price\"\r\n        rules={[\r\n          { required: true, message: 'Please input the instrument price!' },\r\n        ]}\r\n      >\r\n        <Input placeholder=\"i.e. 1000\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        name=\"artistId\"\r\n        rules={[\r\n          { required: true, message: 'Please input the instrument artistId!' },\r\n        ]}\r\n      >\r\n        <Select defaultValue=\"\" style={{ width: 120 }}>\r\n          <Option value=\"\"></Option>\r\n          {data.map((item) => {\r\n            return (\r\n              <Option\r\n                value={item.id}\r\n              >{`${item.firstName} ${item.lastName}`}</Option>\r\n            );\r\n          })}\r\n        </Select>\r\n      </Form.Item>\r\n      <Form.Item shouldUpdate={true}>\r\n        {() => (\r\n          <Button\r\n            type=\"primary\"\r\n            htmlType=\"submit\"\r\n            disabled={\r\n              !form.isFieldsTouched(true) ||\r\n              form.getFieldsError().filter(({ errors }) => errors.length).length\r\n            }\r\n          >\r\n            Add Instrument\r\n          </Button>\r\n        )}\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n};\r\n\r\nexport default AddInstrument;\r\n"]},"metadata":{},"sourceType":"module"}